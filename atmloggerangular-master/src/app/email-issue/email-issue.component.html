<div class="container-fluid">
  <h1>ATM Issue Email Form</h1>
  <form [formGroup]="emailForm" (ngSubmit)="sendEmailMessage()">
    <div *ngIf="isLoading" class="loading">
      <p>This page is still loading...</p>
    </div>
    <div *ngIf="emailIssue && !isLoading">
      <!-- Email Header Section -->
      <div class="form-row">
        <label for="fromEmail"><b>From:</b></label>
        <input
          id="fromEmail"
          formControlName="fromEmail"
          placeholder="Enter sender email"
          title="From Email"
          type="email"
        />
        <small
          *ngIf="
            emailForm.get('fromEmail')?.invalid &&
            emailForm.get('fromEmail')?.touched
          "
          >*The Sender's email is required.</small
        >
      </div>
      
      <div class="form-row">
        <label for="toEmail"><b>To:</b></label>
        <textarea
          id="toEmail"
          formControlName="toEmail"
          placeholder="Enter recipient email"
          title="To Email"
          rows="2"
        ></textarea>
        <small
          *ngIf="
            emailForm.get('toEmail')?.invalid &&
            emailForm.get('toEmail')?.touched
          "
          >*The Recipient's email is required.</small
        >
      </div>
      
      <div class="form-row">
        <label for="cc"><b>Cc:</b></label>
        <textarea
          id="cc"
          formControlName="cc"
          placeholder="Enter CC email"
          title="CC Email"
          rows="2"
        ></textarea>
        <small
          *ngIf="
            emailForm.get('cc')?.invalid && emailForm.get('cc')?.touched
          "
          >*The Carbon copy email is required.</small
        >
      </div>
      
      <div class="form-row">
        <label for="subject"><b>Subject:</b></label>
        <textarea
          id="subject"
          formControlName="subject"
          placeholder="Enter email subject"
          title="Subject"
          rows="2"
        ></textarea>
        <small
          *ngIf="
            emailForm.get('subject')?.invalid &&
            emailForm.get('subject')?.touched
          "
          >*The Subject is required.</small
        >
      </div>
      
      <div class="form-row">
        <label for="mIntro"><b>Message Introduction:</b></label>
        <textarea
          id="mIntro"
          formControlName="mIntro"
          placeholder="Enter message introduction"
          title="Message Introduction"
          rows="3"
        ></textarea>
        <small
          *ngIf="
            emailForm.get('mIntro')?.invalid &&
            emailForm.get('mIntro')?.touched
          "
          >*The message introduction is required.</small
        >
      </div>
      
      <!-- ATM Issue Details Section -->
      <div class="message-section" formGroupName="message">
        <h2>ATM Issue Details</h2>
        
        <div class="form-row">
          <label for="physicalAddress"><b>ATM LOCATION</b></label>
          <input
            id="physicalAddress"
            formControlName="physicalAddress"
            type="text"
            placeholder="Enter the ATM's location"
            title="Physical Address"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('physicalAddress')?.invalid &&
              emailForm.get('message')?.get('physicalAddress')?.touched
            "
            >*The location of the ATM is required.</small
          >
        </div>
    
        <div class="form-row">
          <label for="branchName"><b>BRANCH IN CHARGE</b></label>
          <input
            id="branchName"
            formControlName="branchName"
            type="text"
            placeholder="Enter the branch name for the ATM"
            title="Branch Name"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('branchName')?.invalid &&
              emailForm.get('message')?.get('branchName')?.touched
            "
            >*The name of the branch is required.</small
          >
        </div>
    
        <div class="form-row">
          <label for="vendorName"><b>VENDOR</b></label>
          <input
            id="vendorName"
            formControlName="vendorName"
            type="text"
            placeholder="Enter the vendor name"
            title="Vendor Name"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('vendorName')?.invalid &&
              emailForm.get('message')?.get('vendorName')?.touched
            "
            >*The Vendor's name is required.</small
          >
        </div>
    
        <div class="form-row">
          <label for="issueDesc"><b>ISSUE(S)</b></label>
          <textarea
            id="issueDesc"
            formControlName="issueDesc"
            placeholder="Enter the issues with the ATM"
            title="Issue Description"
            rows="3"
          ></textarea>
          <small
            *ngIf="
              emailForm.get('message')?.get('issueDesc')?.invalid &&
              emailForm.get('message')?.get('issueDesc')?.touched
            "
            >*The details of the issue(s) the ATM has is required.</small
          >
        </div>
    
        <div class="form-row">
          <label for="branchLogger"><b>BRANCH CONTACT</b></label>
          <input
            id="branchLogger"
            formControlName="branchLogger"
            type="text"
            placeholder="Enter the branch contact person"
            title="Branch Contact"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('branchLogger')?.invalid &&
              emailForm.get('message')?.get('branchLogger')?.touched
            "
            >*The branch contact is required.</small
          >
        </div>
    
        <div class="form-row">
          <label for="loggerPhone"><b>CONTACT PHONE NUMBER</b></label>
          <input
            id="loggerPhone"
            formControlName="loggerPhone"
            type="tel"
            placeholder="Enter the contact phone number"
            title="Contact Phone Number"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('loggerPhone')?.invalid &&
              emailForm.get('message')?.get('loggerPhone')?.touched
            "
            >*The personnel's phone number is required (11-14 digits).</small
          >
        </div>
    
        <div class="form-row">
          <label for="dateLogged"><b>DATE LOGGED</b></label>
          <input
            id="dateLogged"
            formControlName="dateLogged"
            type="date"
            placeholder="Enter the date logged"
            title="Date Logged"
          />
          <small
            *ngIf="
              emailForm.get('message')?.get('dateLogged')?.invalid &&
              emailForm.get('message')?.get('dateLogged')?.touched
            "
            >*The date this incident is logged is required.</small
          >
        </div>
      </div>
      
      <div class="form-row">
        <label for="mEnd"><b>MESSAGE END</b></label>
        <textarea
          id="mEnd"
          formControlName="mEnd"
          placeholder="Enter message end"
          title="Message End"
          rows="2"
        ></textarea>
        <small
          *ngIf="
            emailForm.get('mEnd')?.invalid && emailForm.get('mEnd')?.touched
          "
          >*The message ending is required.</small
        >
      </div>
      
      <div class="display">
        <button
          [disabled]="emailForm.invalid || isClicked"
          type="submit"
          class="btn btn-success"
        >
          <i class="fa fa-envelope-o"></i>
          <span>Send Email</span>
        </button>
        <button type="button" class="btn btn-danger" routerLink="/issue-log">
          Re-log issue
        </button>
      </div>
    </div>
  </form>
</div>